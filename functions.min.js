var totalPos=1,selectedCharacter=0,zellen=new Array;zellen[0]=" ";var saveTextToLocalStorageBool=!1,useVollschrift=!0,bit=new Array;function loesch(){(zellen=new Array)[0]=" ",totalPos=1,ausgabe(1),writeToTextAusgabe()}function openManual(){document.getElementById("manual").classList.toggle("show")}function openSettings(){document.getElementById("settings").classList.toggle("show")}function brailleback(e){for(let t=0;t<brailleArray.length;t++)if(e==brailleArray[t][PUNKTCODE]){return useVollschrift?brailleArray[t][ALLEZEICHEN][0]:brailleArray[t][ALLEZEICHEN][brailleArray[t][KURZSCHRIFTPOINTER]]}return!1}function ausgabe(e){screenpos=e;var t=zellen[e-1],r=[0,0,0,0,0,0];"1"==bit[charToBraillecodeArray[t].substr(0,1)].charAt(0)?r[0]=1:r[0]=0,"1"==bit[charToBraillecodeArray[t].substr(0,1)].charAt(1)?r[1]=1:r[1]=0,"1"==bit[charToBraillecodeArray[t].substr(0,1)].charAt(2)?r[2]=1:r[2]=0,"1"==bit[charToBraillecodeArray[t].substr(1,1)].charAt(0)?r[3]=1:r[3]=0,"1"==bit[charToBraillecodeArray[t].substr(1,1)].charAt(1)?r[4]=1:r[4]=0,"1"==bit[charToBraillecodeArray[t].substr(1,1)].charAt(2)?r[5]=1:r[5]=0;for(var o=0;o<6;o++){screenpos;r[o]?document.getElementById(`checkbox${o+1}small`).checked=!0:document.getElementById(`checkbox${o+1}small`).checked=!1}writeToTextAusgabe()}function klick(e,t){var r,o=e;9998==e?(o=totalPos-1,selectedCharacter>0&&(o=selectedCharacter),r=zellen[o]):r=zellen[o];var a,n,l=[0,0,0,0,0,0];"1"==bit[charToBraillecodeArray[r].substr(0,1)].charAt(0)?l[0]=1:l[0]=0,"1"==bit[charToBraillecodeArray[r].substr(0,1)].charAt(1)?l[1]=1:l[1]=0,"1"==bit[charToBraillecodeArray[r].substr(0,1)].charAt(2)?l[2]=1:l[2]=0,"1"==bit[charToBraillecodeArray[r].substr(1,1)].charAt(0)?l[3]=1:l[3]=0,"1"==bit[charToBraillecodeArray[r].substr(1,1)].charAt(1)?l[4]=1:l[4]=0,"1"==bit[charToBraillecodeArray[r].substr(1,1)].charAt(2)?l[5]=1:l[5]=0,l[t-1]?l[t-1]=0:l[t-1]=1,a=bit[l[0].toString()+l[1].toString()+l[2].toString()],n=bit[l[3].toString()+l[4].toString()+l[5].toString()],zellen[o]=brailleback(a+n),writeToTextAusgabe()}function grosseAuslesen(){selectedCharacter=totalPos;var e=[0,0,0,0,0,0];document.getElementById("checkbox1").checked?e[0]=1:e[0]=0,document.getElementById("checkbox2").checked?e[1]=1:e[1]=0,document.getElementById("checkbox3").checked?e[2]=1:e[2]=0,document.getElementById("checkbox4").checked?e[3]=1:e[3]=0,document.getElementById("checkbox5").checked?e[4]=1:e[4]=0,document.getElementById("checkbox6").checked?e[5]=1:e[5]=0,document.getElementById("checkbox1").checked=!1,document.getElementById("checkbox2").checked=!1,document.getElementById("checkbox3").checked=!1,document.getElementById("checkbox4").checked=!1,document.getElementById("checkbox5").checked=!1,document.getElementById("checkbox6").checked=!1,eingabe(bit[e[0].toString()+e[1].toString()+e[2].toString()]+bit[e[3].toString()+e[4].toString()+e[5].toString()]),scrollTextToEnd()}function alternativesZeichen(e){if(e<1)return;let t,r=zellen[e],o=charToBraillecodeArray[r];for(let e=0;e<brailleArray.length;e++)o==brailleArray[e][PUNKTCODE]&&(t=e);let a,n=brailleArray[t][ALLEZEICHEN],l=n.indexOf(r);a=l==n.length-1?0:l+1,zellen[e]=n[a],writeToTextAusgabe()}function lastloe(){1!=totalPos&&(totalPos--,selectedCharacter=totalPos-1,zellen.pop(),ausgabe(totalPos),writeToTextAusgabe())}function eingabe(e){var t=brailleback(e);zellen[totalPos]=t,totalPos++,selectedCharacter=totalPos-1,ausgabe(totalPos)}function zifferncode(e){if("00"==e)return"0";for(var t="",r=bit[e.charAt(0)]+bit[e.charAt(1)]+bit[e.charAt(2)],o=0;o<9;o++)"1"==r.charAt(o)&&(t+=(o+1).toString());return t}bit[0]="000",bit[1]="100",bit[2]="010",bit[3]="110",bit[4]="001",bit[5]="101",bit[6]="011",bit[7]="111",bit["000"]="0",bit[100]="1",bit["010"]="2",bit[110]="3",bit["001"]="4",bit[101]="5",bit["011"]="6",bit[111]="7";var tasten=new Array;function tastbewegung(e,t){27==e.keyCode&&"u"==t&&loesch(),8==e.keyCode&&"u"==t&&lastloe(),"<"==e.key&&"u"==t&&alternativesZeichen(selectedCharacter);var r=String.fromCharCode(e.keyCode);if(/[SDFJKL ]/.test(r)){for(var o=0;o<7;o++)r==tasten[o][0]&&("d"==t?tasten[o][1]=tasten[o][2]=1:"u"==t&&(tasten[o][1]=0));if(!(tasten[0][1]||tasten[1][1]||tasten[2][1]||tasten[3][1]||tasten[4][1]||tasten[5][1]||tasten[6][1])){var a=0;tasten[2][2]&&(a+=1),tasten[1][2]&&(a+=2),tasten[0][2]&&(a+=4);var n=0;tasten[3][2]&&(n+=1),tasten[4][2]&&(n+=2),tasten[5][2]&&(n+=4),eingabe(r=a+""+n),scrollTextToEnd(),tasten[0][2]=tasten[1][2]=tasten[2][2]=tasten[3][2]=tasten[4][2]=tasten[5][2]=tasten[6][2]=0}}}function writeToTextAusgabe(){var e=document.getElementById("textausgabe");e.innerHTML="";let t="",r="";for(let a=1;a<totalPos;a++){var o=zellen[a];void 0!==o&&(t=document.createElement("div"),r=document.createTextNode(o)," "==o&&t.classList.add("space"),a==selectedCharacter&&t.classList.add("selected-character"),t.appendChild(r),t.setAttribute("onclick","selectCharacter("+a+")"),e.appendChild(t))}saveTextToLocalStorage(),removeTestButton()}function selectCharacter(e){ausgabe((selectedCharacter=e)+1)}function scrollTextToEnd(){var e=document.getElementById("textausgabe");e.scrollTop=e.scrollHeight}tasten=[["S",0,0],["D",0,0],["F",0,0],["J",0,0],["K",0,0],["L",0,0],[" ",0,0]];const convertHeight=()=>{const e=window.innerHeight;document.getElementById("body").style.height=`calc(${e}px - 12vmin)`;document.getElementById("manual").style.height=`calc(${e}px - 12vmin)`};function selectLastCharacter(e){const t=document.getElementById("textausgabe");e.target===t&&selectCharacter(totalPos-1)}function copyText(){if(zellen.length<2)return;const e=zellen.join("").slice(1);0!==e.trim().length&&window.isSecureContext&&(navigator.clipboard.writeText(e),alert("Text ist kopiert.\n\n"+e.substring(0,42)+" …"))}function test(){const e=" der weg des gerechten ist von allen seiten von den ungerechtigkeiten der egoisten und der tyrannei der bösen umgeben. gesegnet ist derjenige, der im namen der nächstenliebe und des guten willens die schwachen durch das tal der finsternis führt, denn er ist wahrhaftig der hüter seines bruders und der finder verlorener kinder. und ich werde mit großer rache und zornigem grimm diejenigen schlagen, die versuchen, meine brüder zu vergiften und zu vernichten. und ihr werdet meinen namen erkennen, wenn ich meine rache an euch vollziehe.".split("");totalPos=(zellen=e).length,writeToTextAusgabe(),selectCharacter(totalPos-1),scrollTextToEnd()}function removeTestButton(){const e=document.getElementById("test-button");e&&totalPos>1&&e.remove()}function saveTextToLocalStorage(){window.localStorage&&!1!==saveTextToLocalStorageBool&&localStorage.setObj("zellen",zellen)}function readFromLocalStorage(){null!==localStorage.getItem("zellen")&&(zellen=localStorage.getObj("zellen"),totalPos=zellen.length,writeToTextAusgabe(),selectCharacter(totalPos-1),scrollTextToEnd())}function toggleVollschrift(e){document.getElementById("checkboxVollschrift").checked?(localStorage.removeItem("useVollschrift"),useVollschrift=!0):(localStorage.setObj("useVollschrift",!1),useVollschrift=!1),doNotClickParents(e)}function toggleLocalStorage(e){document.getElementById("checkboxLocalStorage").checked?(saveTextToLocalStorageBool=!0,localStorage.setObj("saveTextToLocalStorageBool",saveTextToLocalStorageBool)):(saveTextToLocalStorageBool=!1,localStorage.removeItem("zellen"),localStorage.removeItem("saveTextToLocalStorageBool")),doNotClickParents(e)}function doNotClickParents(e){e.stopPropagation()}window.addEventListener("resize",convertHeight),window.addEventListener("DOMContentLoaded",convertHeight),Storage.prototype.setObj=function(e,t){return this.setItem(e,JSON.stringify(t))},Storage.prototype.getObj=function(e){return JSON.parse(this.getItem(e))};